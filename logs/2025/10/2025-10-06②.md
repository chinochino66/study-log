# 🧩 1. 復習・ベクトルとは？

> 「数の並び（向きと長さを持つ）」のこと。

📘 例：

$$
\boldsymbol{a} = (2, 3), \quad \boldsymbol{b} = (1, 4)
$$

これは「2次元の矢印」みたいなもの。
x方向に2、y方向に3進んだ点を表してる。

---

# 💡 2. 内積（dot product）とは？

> ざっくり言うと「**2つのベクトルの似てる度合い**」を測るもの。
> もっと物理的に言えば、「**同じ方向にどれだけ力をかけてるか**」。

---

## 📘 定義（計算式）

$$
\boldsymbol{a} \cdot \boldsymbol{b} = a_1b_1 + a_2b_2 + \dots + a_nb_n
$$

例：

$$
(2, 3) \cdot (1, 4) = 2×1 + 3×4 = 14
$$

---

## 📐 幾何的な意味

$$
\boldsymbol{a} \cdot \boldsymbol{b} = |\boldsymbol{a}| |\boldsymbol{b}| \cos\theta
$$

* $|\boldsymbol{a}|$：ベクトルaの長さ
* $\theta$：2つのベクトルのなす角

💬 要するに：

* 同じ方向（θ=0） → cosθ=1 → 内積が最大
* 直角（θ=90°） → cosθ=0 → 内積=0（＝垂直）
* 逆方向（θ=180°） → cosθ=-1 → 内積が負

つまり：

> 内積が大きい＝同じ方向を向いてる
> 内積が0＝垂直（無関係）
> 内積が負＝反対方向

---

# 📏 3. ノルム（norm）とは？

> ベクトルの「**長さ**」を数値化したもの。

---

## 📘 定義

$$
\|\boldsymbol{a}\| = \sqrt{a_1^2 + a_2^2 + \dots + a_n^2}
$$

つまり、ピタゴラスの定理で求めた距離。

例：

$$
\|(3, 4)\| = \sqrt{3^2 + 4^2} = 5
$$

---

## 🧩 ノルムの種類（ざっくり）

* **L2ノルム（普通の長さ）** → 一番よく使う
* **L1ノルム（絶対値の和）** → スパース（Lassoなど）に使う

L2: $\sqrt{a_1^2 + a_2^2 + ...}$
L1: $|a_1| + |a_2| + ...$

---

# 🧮 4. 内積とノルムの関係式（重要）

$$
\|\boldsymbol{a}\|^2 = \boldsymbol{a} \cdot \boldsymbol{a}
$$

💬 つまり「自分自身との内積＝長さ²」。
これがscikit-learnやPyTorchの「norm」や「cosine\_similarity」に直結してる。

---

# ⚖️ 5. 重要な性質①：コーシー＝シュワルツの不等式（C-S不等式）

$$
|\boldsymbol{a} \cdot \boldsymbol{b}| \leq \|\boldsymbol{a}\| \|\boldsymbol{b}\|
$$

---

### 💬 意味：

* 「内積の大きさは、それぞれの長さの掛け算を超えない」
* \=「cosθの絶対値 ≤ 1」と同じこと

📘 例：

$$
(1, 2)・(2, 4) = 10, \quad \|a\|=√5, \|b\|=√20
$$

右辺＝√5×√20=√100=10 → 等号成立（同方向）

---

### ✅ 実務での意義：

これが成り立つおかげで「**コサイン類似度 = 内積 / (長さの積)**」が常に -1〜1 の範囲に収まる。
→ 機械学習で「ベクトルの似てる度」を安全に数値化できる。

---

# ⚖️ 6. 重要な性質②：三角不等式

$$
\|\boldsymbol{a} + \boldsymbol{b}\| \leq \|\boldsymbol{a}\| + \|\boldsymbol{b}\|
$$

---

### 💬 意味：

* 「**最短距離は常に直線**」という物理的事実。
* A→B→C とジグザグ行くより、A→C の直線が短い。

📘 例：

$$
a=(3,4), b=(1,2)
$$

左辺＝‖(4,6)‖=√(52)=7.21
右辺＝‖a‖+‖b‖=5+2.24=7.24
→ 確かに左の方が少し短い。

---

### ✅ 機械学習的な意味：

距離の定義（ユークリッド距離など）がこの「三角不等式」を満たすことで、
**“距離空間”として扱える**（クラスタリングや最近傍探索などが可能になる）。

---

# 🧭 7. まとめ

| 概念     | 直感的な意味    | 数式                | 機械学習での使われ方      |          |                 |
| ------ | --------- | ----------------- | --------------- | -------- | --------------- |
| 内積     | 向きの似てる度合い | $a·b$             | コサイン類似度・線形回帰の基礎 |          |                 |
| ノルム    | ベクトルの長さ   | $\|a\|$           | 標準化、正則化(L2)など   |          |                 |
| C-S不等式 | cosθ≤1の保証 | (                 | a·b             | ≤‖a‖‖b‖) | コサイン類似度を安全に扱うため |
| 三角不等式  | 直線距離が最短   | $\|a+b\|≤‖a‖+‖b‖$ | 距離を使う手法全般の前提条件  |          |                 |

---

今日の要点はこれ👇

> **内積＝方向の似てる度合い、ノルム＝長さ、C-Sと三角不等式＝距離の世界のルール。**
